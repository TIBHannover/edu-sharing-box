---

# (internal) cleanup / set values in client.config.xml
# format:
#   xpath   - xpath where to set the value
#   value   - xml value
#   cleanup - xpath. if set, remove from client.config.xml before set values
edu_client_config_xml_standard_entries:
  - xpath: '/config/values/imprintUrl'
    value: '{{ edu_imprinturl | default("") }}'
  - xpath: '/config/values/privacyInformationUrl'
    value: '{{ edu_privacyInformationUrl | default("") }}'
  - xpath: '/config/values/register/local'
    value: '{{ edu_register_local }}'
  - xpath: '/config/values/register/recoverUrl'
    value: '{{ edu_recover_url }}'
    cleanup: '/config/values/register/recoverUrl'
  - xpath: '/config/values/banner/url'
    value: '{{ edu_banner_url | default("") }}'
    cleanup: '/config/values/banner'
  - xpath: '/config/values/banner/href'
    value: '{{ edu_banner_href | default("") }}'
    cleanup: '/config/values/banner'
  - cleanup: '/config/values/allowedLicenses'
  - cleanup: '/config/values/loginUrl'
  - cleanup: '/config/values/loginAllowLocal'
  - cleanup: '/config/values/loginProvidersUrl'
  - cleanup: '/config/values/loginProviderTargetUrl'
  - cleanup: '/config/values/logout'
  - xpath: '/config/values/workspaceViewType'
    value: '{{ "1" if (edu_workspace_viewType | default("list")) == "tile" else "0" }}'
    cleanup: '/config/values/workspaceViewType'
  - xpath: '/config/values/upload/postDialog'
    value: '{{ edu_upload_post_dialog }}'
  - xpath: '/config/values/publish/licenseMandatory'
    value: '{{ edu_license_mandatory | default(false) }}'
    cleanup: '/config/values/publish/licenseMandatory'
  - xpath: '/config/values/publish/authorMandatory'
    value: '{{ edu_author_mandatory | default(false) }}'
    cleanup: '/config/values/publish/authorMandatory'

# edu-sharing configuration type (edu_version < 5.1: 'edu-sharing.properties' and edu_version >= 5.1: 'edu-sharing.conf'
edu_config_file: 'edu-sharing.conf'

# trusted client configuration for oauthTokenService
edu_oauth_trusted_clients:
  - client: "eduApp"
    password: "secret"

edu_sharing_customization_environment_variable:
  - key: REPOSITORY_SERVICE_PORT
    value: '{{edu_sharing_port | default("80",true)}}'
  - key: REPOSITORY_SERVICE_HOST
    value: '{{edu_sharing_host}}'
  - key: REPOSITORY_SERVICE_MAIL_SERVER_SMTP_PORT
    value: '{{edu_mail_smtp_port if (edu_mail_smtp_server is not none) and (edu_mail_smtp_server is defined) else ""}}'
  - key: REPOSITORY_SERVICE_MAIL_FROM
    value: '{{edu_mail_smtp_from if (edu_mail_smtp_server is not none) and (edu_mail_smtp_server is defined) else ""}}'
  - key: REPOSITORY_SERVICE_MAIL_REPORT_RECEIVER
    value: '{{edu_mail_report_receiver if (edu_mail_smtp_server is not none) and (edu_mail_smtp_server is defined) else ""}}'
  - key: REPOSITORY_SERVICE_MAIL_SERVER_SMTP_USERNAME
    value: '{{edu_mail_smtp_username if (edu_mail_smtp_server is not none) and (edu_mail_smtp_server is defined) else ""}}'
  - key: REPOSITORY_SERVICE_MAIL_SERVER_SMTP_PASSWORD
    value: '{{edu_mail_smtp_passwd if (edu_mail_smtp_server is not none) and (edu_mail_smtp_server is defined) else ""}}'
  - key: REPOSITORY_SERVICE_MAIL_SERVER_SMTP_AUTHTYPE
    value: '{{edu_mail_authtype if (edu_mail_smtp_server is not none) and (edu_mail_smtp_server is defined) else ""}}'
  - key: REPOSITORY_SERVICE_MAIL_SERVER_SMTP_HOST
    value: '{{edu_mail_smtp_server | default("",true)}}'
  - key: REPOSITORY_SERVICE_HOME_APPID
    value: '{{edu_repo_id | default("local",true)}}'

# If we need to override the service name, then we can override it,
# example:  in the edu-sharing-init/vars/versions/8.1.0.yml we add this variable with new value
service_repository_service: 'repository-service'

# DOI service configuration for repository integration with DataCite.
# All fields are required except 'owner'.
edu_doi_configuration:
  enabled: false                # (required) Enable or disable the DOI service.
  repoUrl: '{{edu_sharing_url}}'  # (required) Base URL for repository node entries.
  baseUrl: 'https://api.test.datacite.org'       # (required) DataCite API endpoint (test or production).
  prefix: ''           # (required) DOI prefix assigned by DataCite.
  accountId: ''     # (required) DataCite API account ID.
  password: '' # (required) DataCite API password.

# DOI publishing configuration for copy-based publishing of nodes.
# All fields are required except 'owner'.
edu_doi_publishing_configuration:
  node: ''                     # (required) Node ID where published DOIs will be stored.
  node_pattern: 'yyyy/MM/dd'   # (required) Pattern for organizing published nodes.
  owner: ''                    # (optional) Owner for published DOIs; defaults to node owner if not set.



# Angular UI customization (security headers and robots)
# Configure via edu_angular_configs in inventory/group_vars/host_vars.
# Only headers explicitly defined will be written - no defaults merged.
# Supports both string values and nested objects for complex headers like CSP.
#
# Structure and examples:
# edu_angular_configs:
#   headers:
#     # Simple string headers
#     X-Frame-Options: "DENY"
#     X-XSS-Protection: "1"
#     # Nested object for Content-Security-Policy
#     Content-Security-Policy:
#       default-src: "* data: blob: 'self' gap://ready"
#       connect-src: "* data:"
#       img-src: "* data: blob:"
#       style-src: "* 'unsafe-inline'"
#       script-src: "* 'unsafe-inline' 'unsafe-eval' https://app-registry.edu-sharing.com"
#       font-src: "'self' data:"
#       frame-src: "*"
#   robots:
#     - "User-agent: *"
#     - "Disallow: /admin"
#     - "Sitemap: {{sitemap}}"
#
# Reference: https://github.com/edu-sharing/edu-sharing-community-repository/blob/maven/release/{version}/config/defaults/src/main/resources/edu-sharing.reference.conf#L619-L659

# Examples:
# edu_system_jobs:
#   # Basic job with default trigger (Immediate - runs at startup)
#   - job_class: "org.edu_sharing.repository.server.jobs.quartz.RefreshCacheJob"
#
#   # Job with custom name and cron schedule
#   - job_class: "org.edu_sharing.repository.server.jobs.quartz.TrashcanCleanerJob"
#     name: "Nightly Trash Cleanup"
#     trigger: "Cron[0 0 2 * * ?]"  # Every day at 2:00 AM
#     parameters:
#       timeToKeep: "7776000000"    # 90 days in milliseconds (90 * 24 * 60 * 60 * 1000)
#       batchSize: "5000"           # Process 5000 nodes per batch
#
#   # Job with auto-generated name and additional properties
#   - job_class: "org.edu_sharing.repository.server.jobs.quartz.TimedPermissionJob"
#     trigger: "Cron[0 * * * * ?]"  # Every minute
#     priority: 10                  # Custom property: numeric value
#     enabled: true                 # Custom property: boolean value
#
#   # Job running every Monday at 6:00 AM
#   - job_class: "org.edu_sharing.repository.server.jobs.quartz.BulkEditJob"
#     trigger: "Cron[0 0 6 ? * 1]"
#     parameters:
#       maxNodes: "1000"
#
#   # Job running every 6 hours with custom status
#   - job_class: "org.edu_sharing.repository.server.jobs.quartz.ImporterJob"
#     name: "Periodic Content Import"
#     trigger: "Cron[0 0 */6 * * ?]"
#     status: "active"
#     timeout: "3600000"            # 1 hour timeout in milliseconds